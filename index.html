// ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙÙ‚Ø§Øª Ù…Ù† Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø¹Ù†Ø¯ Ø¨Ø¯Ø¡ Ø§Ù„ØµÙØ­Ø©
window.onload = function() {
  loadTradesFromStorage();
};

function saveTrade() {
  // ... Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù‚Ø¯ÙŠÙ… ...
  
  // Ø­ÙØ¸ ÙÙŠ localStorage
  saveTradeToStorage({
    pair, type, entry, sl, tp,
    result: "Ø¬Ø§Ø±ÙŠØ©",
    conditionsMet: true,
    timestamp: new Date().toISOString()
  });

  // ... Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù‚Ø¯ÙŠÙ… ...
}

function saveTradeToStorage(trade) {
  let trades = JSON.parse(localStorage.getItem("trades") || "[]");
  trades.push(trade);
  localStorage.setItem("trades", JSON.stringify(trades));
}

function loadTradesFromStorage() {
  let trades = JSON.parse(localStorage.getItem("trades") || "[]");
  trades.forEach(trade => addTradeToTable(trade));
}

function addTradeToTable(trade) {
  tradeCount++;

  const table = document.getElementById("tradesTable").querySelector("tbody");
  const row = document.createElement("tr");

  const resultCell = document.createElement("td");
  const resultSelect = document.createElement("select");
  resultSelect.innerHTML = `
    <option value="Ø¬Ø§Ø±ÙŠØ©" ${trade.result === "Ø¬Ø§Ø±ÙŠØ©" ? "selected" : ""}>ğŸ”„ Ø¬Ø§Ø±ÙŠØ©</option>
    <option value="Ø±Ø¨Ø­" ${trade.result === "Ø±Ø¨Ø­" ? "selected" : ""}>âœ… Ø±Ø¨Ø­</option>
    <option value="Ø®Ø³Ø§Ø±Ø©" ${trade.result === "Ø®Ø³Ø§Ø±Ø©" ? "selected" : ""}>âŒ Ø®Ø³Ø§Ø±Ø©</option>
  `;
  // Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ù†ØªÙŠØ¬Ø© Ù†Ø­Ø¯Ø« Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø£ÙŠØ¶Ø§Ù‹
  resultSelect.addEventListener("change", function() {
    updateTradeResult(trade.timestamp, this.value);
  });
  resultCell.appendChild(resultSelect);

  row.innerHTML = `
    <td data-label="#">${tradeCount}</td>
    <td data-label="Ø§Ù„Ø²ÙˆØ¬">${trade.pair}</td>
    <td data-label="Ø§Ù„Ù†ÙˆØ¹">${trade.type}</td>
    <td data-label="Ø¯Ø®ÙˆÙ„">${trade.entry}</td>
    <td data-label="ÙˆÙ‚Ù">${trade.sl}</td>
    <td data-label="Ù‡Ø¯Ù">${trade.tp}</td>
  `;
  row.appendChild(resultCell);
  row.innerHTML += `<td data-label="Ø§Ù„Ø´Ø±ÙˆØ·">âœ…</td>`;

  table.appendChild(row);
}

function updateTradeResult(timestamp, newResult) {
  let trades = JSON.parse(localStorage.getItem("trades") || "[]");
  let index = trades.findIndex(t => t.timestamp === timestamp);
  if (index !== -1) {
    trades[index].result = newResult;
    localStorage.setItem("trades", JSON.stringify(trades));
  }
}
